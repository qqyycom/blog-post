# ARP协议

ARP（Address Resolution Protocol）即地址解析协议， 用于实现从 IP 地址到 MAC 地址的映射，即询问目标IP对应的MAC地址。

在网络通信中，主机和主机通信的数据包需要依据OSI模型从上到下进行数据封装，当数据封装完整后，再向外发出。所以在局域网的通信中，不仅需要源目IP地址的封装，也需要源目MAC的封装。

一般情况下，上层应用程序更多关心IP地址而不关心MAC地址，所以需要通过ARP协议来获知目的主机的MAC地址，完成数据封装。

**广播请求, 单播响应**

如果IP不属于内网, 则由路由器返回响应包, 相当于"欺骗"了源主机, 让源主机把帧发给路由器, 路由器收到帧后, 然后再提交给IP层，IP层查询路由表，找到与目的主机直连得接口，发ARP请求B的MAC地址，然后完成最终的通信